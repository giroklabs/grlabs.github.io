<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ì¦ì—¬ì„¸ ê³„ì‚°ê¸°</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', 'Apple SD Gothic Neo', Arial, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
      color: #333;
    }

    .container {
      max-width: 800px;
      margin: 0 auto;
      background: #fff;
      border-radius: 20px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
      overflow: hidden;
    }

    .header {
      background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
      color: white;
      padding: 30px;
      text-align: center;
    }

    .header h1 {
      font-size: 2.5rem;
      font-weight: 600;
      margin-bottom: 10px;
    }

    .header p {
      font-size: 1.1rem;
      opacity: 0.9;
    }

    .content {
      padding: 40px;
    }

    .form-group {
      margin-bottom: 25px;
    }

    .form-row {
      display: flex;
      gap: 20px;
      margin-bottom: 25px;
    }

    .form-row .form-group {
      flex: 1;
      margin-bottom: 0;
    }

    label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      color: #333;
      font-size: 1rem;
    }

    input, select {
      width: 100%;
      padding: 15px;
      border: 2px solid #e1e5e9;
      border-radius: 10px;
      font-size: 1rem;
      transition: all 0.3s ease;
      background-color: #fff;
    }

    input:focus, select:focus {
      outline: none;
      border-color: #4facfe;
      box-shadow: 0 0 0 3px rgba(79, 172, 254, 0.1);
    }

    .calculate-btn {
      width: 100%;
      padding: 18px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      border-radius: 12px;
      font-size: 1.2rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      margin: 30px 0;
    }

    .calculate-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
    }

    .calculate-btn:active {
      transform: translateY(0);
    }

    .result {
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      color: white;
      padding: 30px;
      border-radius: 15px;
      margin-top: 30px;
      display: none;
    }

    .result.show {
      display: block;
      animation: slideIn 0.5s ease-out;
    }

    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .result h3 {
      font-size: 1.5rem;
      margin-bottom: 20px;
      text-align: center;
    }

    .result-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 0;
      border-bottom: 1px solid rgba(255, 255, 255, 0.2);
    }

    .result-item:last-child {
      border-bottom: none;
      font-weight: 600;
      font-size: 1.2rem;
      margin-top: 10px;
      padding-top: 20px;
      border-top: 2px solid rgba(255, 255, 255, 0.3);
    }

    .result-label {
      font-weight: 500;
    }

    .result-value {
      font-weight: 600;
      font-size: 1.1rem;
    }

    .info-section {
      background: #f8fafc;
      padding: 25px;
      border-radius: 12px;
      margin-top: 30px;
      border-left: 4px solid #4facfe;
    }

    .info-section h4 {
      color: #333;
      margin-bottom: 15px;
      font-size: 1.2rem;
    }

    .info-section ul {
      list-style: none;
      padding-left: 0;
    }

    .info-section li {
      padding: 8px 0;
      color: #666;
      position: relative;
      padding-left: 20px;
    }

    .info-section li:before {
      content: "â€¢";
      color: #4facfe;
      font-weight: bold;
      position: absolute;
      left: 0;
    }

    .tax-table {
      margin-top: 20px;
      width: 100%;
      border-collapse: collapse;
      background: white;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    .tax-table th,
    .tax-table td {
      padding: 12px 15px;
      text-align: center;
      border-bottom: 1px solid #eee;
    }

    .tax-table th {
      background: #4facfe;
      color: white;
      font-weight: 600;
    }

    .tax-table tr:hover {
      background: #f8fafc;
    }

    @media (max-width: 768px) {
      .header h1 {
        font-size: 2rem;
      }
      
      .content {
        padding: 20px;
      }
      
      .form-row {
        flex-direction: column;
        gap: 0;
      }
      
      .tax-table {
        font-size: 0.9rem;
      }
      
      .tax-table th,
      .tax-table td {
        padding: 8px 10px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>ì¦ì—¬ì„¸ ê³„ì‚°ê¸°</h1>
      <p>2024ë…„ ê¸°ì¤€ í•œêµ­ ì¦ì—¬ì„¸ ë²•ë ¹ì— ë”°ë¥¸ ì •í™•í•œ ê³„ì‚°</p>
    </div>

    <div class="content">
      <form id="giftTaxForm">
        <div class="form-row">
          <div class="form-group">
            <label for="giftAmount">ì¦ì—¬ì¬ì‚° ê°€ì•¡ (ì›)</label>
            <input type="number" id="giftAmount" placeholder="ì˜ˆ: 100000000" required>
          </div>
          <div class="form-group">
            <label for="relationship">ì¦ì—¬ìì™€ì˜ ê´€ê³„</label>
            <select id="relationship" required>
              <option value="">ê´€ê³„ ì„ íƒ</option>
              <option value="spouse">ë°°ìš°ì</option>
              <option value="lineal">ì§ê³„ì¡´ë¹„ì† (ë¶€ëª¨, ìë…€, ì¡°ë¶€ëª¨, ì†ìë…€)</option>
              <option value="sibling">í˜•ì œìë§¤</option>
              <option value="other">ê¸°íƒ€ ì¹œì¡±</option>
              <option value="stranger">íƒ€ì¸</option>
            </select>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="recipientAge">ìˆ˜ì¦ì ì—°ë ¹</label>
            <select id="recipientAge" required>
              <option value="">ì—°ë ¹ ì„ íƒ</option>
              <option value="minor">ë¯¸ì„±ë…„ì (19ì„¸ ë¯¸ë§Œ)</option>
              <option value="adult">ì„±ì¸ (19ì„¸ ì´ìƒ)</option>
            </select>
          </div>
          <div class="form-group">
            <label for="priorGifts">ê¸°ì¡´ ì¦ì—¬ì•¡ (ìµœê·¼ 10ë…„ ë‚´, ì›)</label>
            <input type="number" id="priorGifts" placeholder="ì˜ˆ: 50000000" value="0">
          </div>
        </div>

        <button type="submit" class="calculate-btn">ì¦ì—¬ì„¸ ê³„ì‚°í•˜ê¸°</button>
      </form>

      <div id="result" class="result">
        <h3>ê³„ì‚° ê²°ê³¼</h3>
        <div class="result-item">
          <span class="result-label">ì¦ì—¬ì¬ì‚° ê°€ì•¡:</span>
          <span class="result-value" id="totalGiftAmount">-</span>
        </div>
        <div class="result-item">
          <span class="result-label">ì¦ì—¬ê³µì œì•¡:</span>
          <span class="result-value" id="deductionAmount">-</span>
        </div>
        <div class="result-item">
          <span class="result-label">ê³¼ì„¸í‘œì¤€:</span>
          <span class="result-value" id="taxableAmount">-</span>
        </div>
        <div class="result-item">
          <span class="result-label">ì‚°ì¶œì„¸ì•¡:</span>
          <span class="result-value" id="calculatedTax">-</span>
        </div>
        <div class="result-item">
          <span class="result-label">ì„¸ì•¡ê³µì œ:</span>
          <span class="result-value" id="taxCredit">-</span>
        </div>
        <div class="result-item">
          <span class="result-label">ìµœì¢… ë‚©ë¶€í•  ì¦ì—¬ì„¸:</span>
          <span class="result-value" id="finalTax">-</span>
        </div>
      </div>

      <div class="info-section">
        <h4>ğŸ“‹ ì¦ì—¬ê³µì œ í•œë„ì•¡ (10ë…„ ëˆ„ê³„)</h4>
        <ul>
          <li><strong>ë°°ìš°ì:</strong> 6ì–µì›</li>
          <li><strong>ì§ê³„ì¡´ë¹„ì†:</strong> ì„±ì¸ 5ì²œë§Œì›, ë¯¸ì„±ë…„ì 2ì²œë§Œì›</li>
          <li><strong>í˜•ì œìë§¤:</strong> 1ì²œë§Œì›</li>
          <li><strong>ê¸°íƒ€ ì¹œì¡±:</strong> 500ë§Œì›</li>
          <li><strong>íƒ€ì¸:</strong> ê³µì œ ì—†ìŒ</li>
        </ul>

        <h4 style="margin-top: 25px;">ğŸ“Š ì¦ì—¬ì„¸ìœ¨í‘œ</h4>
        <table class="tax-table">
          <thead>
            <tr>
              <th>ê³¼ì„¸í‘œì¤€</th>
              <th>ì„¸ìœ¨</th>
              <th>ëˆ„ì§„ê³µì œì•¡</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>1ì–µì› ì´í•˜</td>
              <td>10%</td>
              <td>-</td>
            </tr>
            <tr>
              <td>1ì–µì› ì´ˆê³¼ ~ 5ì–µì› ì´í•˜</td>
              <td>20%</td>
              <td>1ì²œë§Œì›</td>
            </tr>
            <tr>
              <td>5ì–µì› ì´ˆê³¼ ~ 10ì–µì› ì´í•˜</td>
              <td>30%</td>
              <td>6ì²œë§Œì›</td>
            </tr>
            <tr>
              <td>10ì–µì› ì´ˆê³¼ ~ 30ì–µì› ì´í•˜</td>
              <td>40%</td>
              <td>1ì–µ 6ì²œë§Œì›</td>
            </tr>
            <tr>
              <td>30ì–µì› ì´ˆê³¼</td>
              <td>50%</td>
              <td>4ì–µ 6ì²œë§Œì›</td>
            </tr>
          </tbody>
        </table>

        <h4 style="margin-top: 25px;">âš ï¸ ì£¼ì˜ì‚¬í•­</h4>
        <ul>
          <li>ë³¸ ê³„ì‚°ê¸°ëŠ” 2024ë…„ ê¸°ì¤€ ì„¸ë²•ì„ ì ìš©í•œ ì°¸ê³ ìš©ì…ë‹ˆë‹¤.</li>
          <li>ì‹¤ì œ ì‹ ê³  ì‹œì—ëŠ” ì„¸ë¬´ì „ë¬¸ê°€ì™€ ìƒë‹´í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.</li>
          <li>ì¦ì—¬ì„¸ ì‹ ê³ ëŠ” ì¦ì—¬ì¼ì´ ì†í•˜ëŠ” ë‹¬ì˜ ë§ì¼ë¶€í„° 3ê°œì›” ì´ë‚´ì— í•´ì•¼ í•©ë‹ˆë‹¤.</li>
        </ul>
      </div>
    </div>
  </div>

  <script>
    // ì¦ì—¬ê³µì œ í•œë„ì•¡ (10ë…„ ëˆ„ê³„)
    const deductionLimits = {
      spouse: 600000000,        // ë°°ìš°ì: 6ì–µì›
      lineal_adult: 50000000,   // ì§ê³„ì¡´ë¹„ì† ì„±ì¸: 5ì²œë§Œì›
      lineal_minor: 20000000,   // ì§ê³„ì¡´ë¹„ì† ë¯¸ì„±ë…„ì: 2ì²œë§Œì›
      sibling: 10000000,        // í˜•ì œìë§¤: 1ì²œë§Œì›
      other: 5000000,           // ê¸°íƒ€ ì¹œì¡±: 500ë§Œì›
      stranger: 0               // íƒ€ì¸: ê³µì œ ì—†ìŒ
    };

    // ì¦ì—¬ì„¸ìœ¨í‘œ
    const taxRates = [
      { limit: 100000000, rate: 0.10, deduction: 0 },         // 1ì–µì› ì´í•˜: 10%
      { limit: 500000000, rate: 0.20, deduction: 10000000 },  // 5ì–µì› ì´í•˜: 20% (ëˆ„ì§„ê³µì œ 1ì²œë§Œì›)
      { limit: 1000000000, rate: 0.30, deduction: 60000000 }, // 10ì–µì› ì´í•˜: 30% (ëˆ„ì§„ê³µì œ 6ì²œë§Œì›)
      { limit: 3000000000, rate: 0.40, deduction: 160000000 }, // 30ì–µì› ì´í•˜: 40% (ëˆ„ì§„ê³µì œ 1ì–µ6ì²œë§Œì›)
      { limit: Infinity, rate: 0.50, deduction: 460000000 }   // 30ì–µì› ì´ˆê³¼: 50% (ëˆ„ì§„ê³µì œ 4ì–µ6ì²œë§Œì›)
    ];

    function formatNumber(num) {
      return new Intl.NumberFormat('ko-KR').format(Math.round(num)) + 'ì›';
    }

    function getDeductionLimit(relationship, age) {
      if (relationship === 'spouse') return deductionLimits.spouse;
      if (relationship === 'lineal') {
        return age === 'adult' ? deductionLimits.lineal_adult : deductionLimits.lineal_minor;
      }
      if (relationship === 'sibling') return deductionLimits.sibling;
      if (relationship === 'other') return deductionLimits.other;
      if (relationship === 'stranger') return deductionLimits.stranger;
      return 0;
    }

    function calculateTax(taxableAmount) {
      if (taxableAmount <= 0) return 0;

      for (const bracket of taxRates) {
        if (taxableAmount <= bracket.limit) {
          return Math.max(0, taxableAmount * bracket.rate - bracket.deduction);
        }
      }
      return 0;
    }

    function calculateGiftTax() {
      const giftAmount = parseInt(document.getElementById('giftAmount').value) || 0;
      const relationship = document.getElementById('relationship').value;
      const recipientAge = document.getElementById('recipientAge').value;
      const priorGifts = parseInt(document.getElementById('priorGifts').value) || 0;

      if (!giftAmount || !relationship || !recipientAge) {
        alert('ëª¨ë“  í•„ìˆ˜ í•­ëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
        return;
      }

      // 1. ì´ ì¦ì—¬ì•¡ (ê¸°ì¡´ ì¦ì—¬ì•¡ + í˜„ì¬ ì¦ì—¬ì•¡)
      const totalGiftAmount = priorGifts + giftAmount;

      // 2. ì¦ì—¬ê³µì œ í•œë„ì•¡
      const deductionLimit = getDeductionLimit(relationship, recipientAge);

      // 3. ì‹¤ì œ ê³µì œì•¡ (ê³µì œí•œë„ì™€ ì´ì¦ì—¬ì•¡ ì¤‘ ì‘ì€ ê¸ˆì•¡)
      const actualDeduction = Math.min(deductionLimit, totalGiftAmount);

      // 4. ê³¼ì„¸í‘œì¤€ (ì´ì¦ì—¬ì•¡ - ê³µì œì•¡)
      const taxableAmount = Math.max(0, totalGiftAmount - actualDeduction);

      // 5. ì‚°ì¶œì„¸ì•¡
      const calculatedTax = calculateTax(taxableAmount);

      // 6. ê¸°ì¡´ ì¦ì—¬ì— ëŒ€í•œ ì„¸ì•¡ (ì°¨ê°í•  ì„¸ì•¡)
      const priorTaxableAmount = Math.max(0, priorGifts - actualDeduction);
      const priorTax = priorTaxableAmount > 0 ? calculateTax(Math.max(0, priorGifts - Math.min(deductionLimit, priorGifts))) : 0;

      // 7. ì„¸ì•¡ê³µì œ (ê¸°ë³¸ê³µì œ 250ë§Œì›, ê³¼ì„¸í‘œì¤€ì´ ìˆëŠ” ê²½ìš°ì—ë§Œ)
      const taxCredit = taxableAmount > 0 ? Math.min(2500000, calculatedTax) : 0;

      // 8. ìµœì¢… ë‚©ë¶€ì„¸ì•¡
      const finalTax = Math.max(0, calculatedTax - priorTax - taxCredit);

      // ê²°ê³¼ í‘œì‹œ
      document.getElementById('totalGiftAmount').textContent = formatNumber(totalGiftAmount);
      document.getElementById('deductionAmount').textContent = formatNumber(actualDeduction);
      document.getElementById('taxableAmount').textContent = formatNumber(taxableAmount);
      document.getElementById('calculatedTax').textContent = formatNumber(calculatedTax);
      document.getElementById('taxCredit').textContent = formatNumber(taxCredit);
      document.getElementById('finalTax').textContent = formatNumber(finalTax);

      document.getElementById('result').classList.add('show');
      document.getElementById('result').scrollIntoView({ behavior: 'smooth' });
    }

    document.getElementById('giftTaxForm').addEventListener('submit', function(e) {
      e.preventDefault();
      calculateGiftTax();
    });

    // ì…ë ¥ê°’ ë³€ê²½ ì‹œ ìë™ ê³„ì‚°
    document.getElementById('giftAmount').addEventListener('input', function() {
      if (this.value && document.getElementById('relationship').value && document.getElementById('recipientAge').value) {
        calculateGiftTax();
      }
    });

    document.getElementById('relationship').addEventListener('change', function() {
      if (document.getElementById('giftAmount').value && this.value && document.getElementById('recipientAge').value) {
        calculateGiftTax();
      }
    });

    document.getElementById('recipientAge').addEventListener('change', function() {
      if (document.getElementById('giftAmount').value && document.getElementById('relationship').value && this.value) {
        calculateGiftTax();
      }
    });

    document.getElementById('priorGifts').addEventListener('input', function() {
      if (document.getElementById('giftAmount').value && document.getElementById('relationship').value && document.getElementById('recipientAge').value) {
        calculateGiftTax();
      }
    });
  </script>
</body>
</html>