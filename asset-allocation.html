<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>자산 배분 계산기 - GIROK labs</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', 'Apple SD Gothic Neo', Arial, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      color: #333;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }

    .header {
      text-align: center;
      color: white;
      margin-bottom: 30px;
    }

    .header h1 {
      font-size: 2.5em;
      margin-bottom: 10px;
      text-shadow: 0 2px 4px rgba(0,0,0,0.3);
    }

    .nav-link {
      color: white;
      text-decoration: none;
      margin: 0 10px;
      padding: 8px 16px;
      border-radius: 20px;
      background: rgba(255,255,255,0.2);
      transition: background 0.3s ease;
    }

    .nav-link:hover {
      background: rgba(255,255,255,0.3);
    }

    .calculator-container {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-bottom: 30px;
    }

    .calculator-card {
      background: white;
      border-radius: 16px;
      padding: 30px;
      box-shadow: 0 8px 32px rgba(0,0,0,0.1);
    }

    .card-title {
      font-size: 1.4em;
      color: #2563eb;
      margin-bottom: 20px;
      text-align: center;
      font-weight: 600;
    }

    .input-group {
      margin-bottom: 15px;
    }

    .input-group label {
      display: block;
      margin-bottom: 8px;
      font-weight: 500;
      color: #374151;
    }

    .input-group input, .input-group select {
      width: 100%;
      padding: 12px 16px;
      border: 2px solid #e5e7eb;
      border-radius: 8px;
      font-size: 16px;
      transition: border-color 0.3s ease;
    }

    .input-group input:focus, .input-group select:focus {
      outline: none;
      border-color: #2563eb;
    }

    .allocation-slider {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 10px;
    }

    .allocation-slider input[type="range"] {
      flex: 1;
      height: 6px;
      border-radius: 3px;
      background: #e5e7eb;
      outline: none;
      -webkit-appearance: none;
    }

    .allocation-slider input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: #2563eb;
      cursor: pointer;
    }

    .allocation-value {
      min-width: 50px;
      font-weight: 600;
      color: #2563eb;
    }

    .calculate-btn {
      width: 100%;
      background: linear-gradient(135deg, #2563eb, #3b82f6);
      color: white;
      border: none;
      padding: 14px 20px;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      margin-top: 10px;
    }

    .calculate-btn:hover {
      background: linear-gradient(135deg, #1d4ed8, #2563eb);
      transform: translateY(-1px);
    }

    .result {
      margin-top: 20px;
      padding: 20px;
      background: #f0f9ff;
      border-radius: 8px;
      border-left: 4px solid #2563eb;
    }

    .result h3 {
      color: #1e40af;
      margin-bottom: 15px;
    }

    .result-item {
      margin: 8px 0;
      font-size: 1.1em;
    }

    .highlight {
      font-weight: 600;
      color: #dc2626;
    }

    .success {
      color: #059669;
    }

    .chart-container {
      height: 300px;
      background: #f8fafc;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-top: 20px;
      position: relative;
    }

    .pie-chart {
      width: 250px;
      height: 250px;
      border-radius: 50%;
      position: relative;
      margin: 0 auto;
    }

    .age-recommendation {
      background: white;
      border-radius: 16px;
      padding: 30px;
      box-shadow: 0 8px 32px rgba(0,0,0,0.1);
      margin-top: 20px;
    }

    .age-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin-top: 20px;
    }

    .age-card {
      background: #f8fafc;
      padding: 20px;
      border-radius: 8px;
      text-align: center;
      border-left: 4px solid #2563eb;
    }

    .age-card h4 {
      color: #2563eb;
      margin-bottom: 10px;
    }

    @media (max-width: 768px) {
      .calculator-container {
        grid-template-columns: 1fr;
      }
      
      .header h1 {
        font-size: 2em;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>📊 자산 배분 계산기</h1>
      <p>나이와 위험성향에 맞는 최적의 포트폴리오를 설계하세요</p>
      <div style="margin-top: 15px;">
        <a href="index.html" class="nav-link">🏠 홈</a>
        <a href="fire-calculator.html" class="nav-link">🔥 FIRE 계산기</a>
        <a href="expense-tracker.html" class="nav-link">💸 지출 분석</a>
        <a href="gift-tax-calculator.html" class="nav-link">💰 증여세 계산기</a>
      </div>
    </div>

    <div class="calculator-container">
      <!-- 자산 배분 입력 -->
      <div class="calculator-card">
        <div class="card-title">💼 자산 배분 설정</div>
        
        <div class="input-group">
          <label for="totalAssets">총 투자 자산 (만원)</label>
          <input type="number" id="totalAssets" value="5000" min="0">
        </div>
        
        <div class="input-group">
          <label for="investorAge">투자자 나이</label>
          <input type="number" id="investorAge" value="35" min="20" max="80">
        </div>
        
        <div class="input-group">
          <label for="riskTolerance">위험 성향</label>
          <select id="riskTolerance">
            <option value="conservative">보수적 (안정성 중시)</option>
            <option value="moderate" selected>중도적 (균형 추구)</option>
            <option value="aggressive">적극적 (수익성 중시)</option>
          </select>
        </div>

        <div class="input-group">
          <label>자산 배분 비율 조정</label>
          
          <div class="allocation-slider">
            <label style="min-width: 60px;">주식</label>
            <input type="range" id="stockRatio" min="0" max="100" value="60" oninput="updateAllocation()">
            <span class="allocation-value" id="stockValue">60%</span>
          </div>
          
          <div class="allocation-slider">
            <label style="min-width: 60px;">채권</label>
            <input type="range" id="bondRatio" min="0" max="100" value="30" oninput="updateAllocation()">
            <span class="allocation-value" id="bondValue">30%</span>
          </div>
          
          <div class="allocation-slider">
            <label style="min-width: 60px;">현금</label>
            <input type="range" id="cashRatio" min="0" max="100" value="10" oninput="updateAllocation()">
            <span class="allocation-value" id="cashValue">10%</span>
          </div>
        </div>

        <button class="calculate-btn" onclick="calculateAllocation()">자산 배분 계산</button>
        <button class="calculate-btn" onclick="getRecommendation()" style="background: linear-gradient(135deg, #059669, #10b981); margin-top: 10px;">나이별 추천 배분</button>
      </div>

      <!-- 결과 표시 -->
      <div class="calculator-card">
        <div class="card-title">📈 배분 결과</div>
        
        <div id="allocationResult" class="result" style="display: none;">
          <h3>💰 자산 배분 결과</h3>
          <div id="allocationDetails"></div>
          <div class="chart-container">
            <canvas id="pieChart" width="250" height="250"></canvas>
          </div>
        </div>

        <div id="projectionResult" class="result" style="display: none; margin-top: 20px;">
          <h3>📊 10년 후 예상 자산</h3>
          <div id="projectionDetails"></div>
        </div>
      </div>
    </div>

    <!-- 나이별 추천 배분 -->
    <div class="age-recommendation">
      <h2 style="text-align: center; color: #2563eb; margin-bottom: 20px;">👥 나이별 추천 자산 배분</h2>
      <div class="age-grid">
        <div class="age-card">
          <h4>20-30대</h4>
          <p>주식 70-80%<br>채권 15-25%<br>현금 5-10%</p>
          <small>장기 성장 중심</small>
        </div>
        <div class="age-card">
          <h4>40대</h4>
          <p>주식 60-70%<br>채권 25-35%<br>현금 5-10%</p>
          <small>성장과 안정의 균형</small>
        </div>
        <div class="age-card">
          <h4>50대</h4>
          <p>주식 40-60%<br>채권 35-50%<br>현금 5-15%</p>
          <small>안정성 비중 증가</small>
        </div>
        <div class="age-card">
          <h4>60대 이상</h4>
          <p>주식 20-40%<br>채권 50-70%<br>현금 10-20%</p>
          <small>원금 보존 중심</small>
        </div>
      </div>
    </div>
  </div>

  <script>
    // 숫자 포맷팅 함수
    function formatNumber(num) {
      return new Intl.NumberFormat('ko-KR').format(Math.round(num));
    }

    // 자산 배분 비율 업데이트
    function updateAllocation() {
      const stock = parseInt(document.getElementById('stockRatio').value);
      const bond = parseInt(document.getElementById('bondRatio').value);
      const cash = parseInt(document.getElementById('cashRatio').value);
      
      const total = stock + bond + cash;
      
      if (total !== 100) {
        // 자동으로 비율 조정
        const remaining = 100 - stock - bond;
        if (remaining >= 0 && remaining <= 100) {
          document.getElementById('cashRatio').value = remaining;
          document.getElementById('cashValue').textContent = remaining + '%';
        }
      }
      
      document.getElementById('stockValue').textContent = stock + '%';
      document.getElementById('bondValue').textContent = bond + '%';
      document.getElementById('cashValue').textContent = document.getElementById('cashRatio').value + '%';
    }

    // 나이별 추천 배분 적용
    function getRecommendation() {
      const age = parseInt(document.getElementById('investorAge').value);
      const riskTolerance = document.getElementById('riskTolerance').value;
      
      let stockRatio, bondRatio, cashRatio;
      
      if (age <= 30) {
        stockRatio = riskTolerance === 'conservative' ? 60 : riskTolerance === 'moderate' ? 70 : 80;
        bondRatio = riskTolerance === 'conservative' ? 30 : riskTolerance === 'moderate' ? 25 : 15;
        cashRatio = riskTolerance === 'conservative' ? 10 : 5;
      } else if (age <= 40) {
        stockRatio = riskTolerance === 'conservative' ? 50 : riskTolerance === 'moderate' ? 65 : 75;
        bondRatio = riskTolerance === 'conservative' ? 40 : riskTolerance === 'moderate' ? 30 : 20;
        cashRatio = riskTolerance === 'conservative' ? 10 : 5;
      } else if (age <= 50) {
        stockRatio = riskTolerance === 'conservative' ? 40 : riskTolerance === 'moderate' ? 55 : 65;
        bondRatio = riskTolerance === 'conservative' ? 50 : riskTolerance === 'moderate' ? 35 : 25;
        cashRatio = riskTolerance === 'conservative' ? 10 : riskTolerance === 'moderate' ? 10 : 10;
      } else {
        stockRatio = riskTolerance === 'conservative' ? 25 : riskTolerance === 'moderate' ? 35 : 45;
        bondRatio = riskTolerance === 'conservative' ? 65 : riskTolerance === 'moderate' ? 55 : 45;
        cashRatio = riskTolerance === 'conservative' ? 10 : riskTolerance === 'moderate' ? 10 : 10;
      }
      
      document.getElementById('stockRatio').value = stockRatio;
      document.getElementById('bondRatio').value = bondRatio;
      document.getElementById('cashRatio').value = cashRatio;
      
      updateAllocation();
      calculateAllocation();
    }

    // 자산 배분 계산
    function calculateAllocation() {
      const totalAssets = parseFloat(document.getElementById('totalAssets').value) * 10000;
      const stockRatio = parseInt(document.getElementById('stockRatio').value) / 100;
      const bondRatio = parseInt(document.getElementById('bondRatio').value) / 100;
      const cashRatio = parseInt(document.getElementById('cashRatio').value) / 100;
      
      const stockAmount = totalAssets * stockRatio;
      const bondAmount = totalAssets * bondRatio;
      const cashAmount = totalAssets * cashRatio;
      
      // 예상 수익률 (역사적 평균 기준)
      const stockReturn = 0.08; // 8%
      const bondReturn = 0.04; // 4%
      const cashReturn = 0.02; // 2%
      
      const portfolioReturn = (stockRatio * stockReturn + bondRatio * bondReturn + cashRatio * cashReturn) * 100;
      const portfolioRisk = Math.sqrt(Math.pow(stockRatio * 0.16, 2) + Math.pow(bondRatio * 0.05, 2)) * 100; // 단순화된 위험도
      
      // 10년 후 예상 자산
      const projectedAssets = totalAssets * Math.pow(1 + portfolioReturn/100, 10);
      
      const resultDiv = document.getElementById('allocationResult');
      const detailsDiv = document.getElementById('allocationDetails');
      
      detailsDiv.innerHTML = `
        <div class="result-item">주식 투자액: <span class="success">${formatNumber(stockAmount/10000)}만원</span> (${(stockRatio*100).toFixed(0)}%)</div>
        <div class="result-item">채권 투자액: <span class="success">${formatNumber(bondAmount/10000)}만원</span> (${(bondRatio*100).toFixed(0)}%)</div>
        <div class="result-item">현금 보유액: <span class="success">${formatNumber(cashAmount/10000)}만원</span> (${(cashRatio*100).toFixed(0)}%)</div>
        <div class="result-item">포트폴리오 예상 수익률: <span class="highlight">${portfolioReturn.toFixed(1)}%</span></div>
        <div class="result-item">포트폴리오 위험도: <span class="highlight">${portfolioRisk.toFixed(1)}%</span></div>
      `;
      
      // 10년 후 예상 결과
      const projectionDiv = document.getElementById('projectionResult');
      const projectionDetailsDiv = document.getElementById('projectionDetails');
      
      projectionDetailsDiv.innerHTML = `
        <div class="result-item">현재 자산: <span class="highlight">${formatNumber(totalAssets/10000)}만원</span></div>
        <div class="result-item">10년 후 예상 자산: <span class="success">${formatNumber(projectedAssets/10000)}만원</span></div>
        <div class="result-item">예상 수익: <span class="success">${formatNumber((projectedAssets-totalAssets)/10000)}만원</span></div>
        <div class="result-item">총 수익률: <span class="success">${(((projectedAssets/totalAssets)-1)*100).toFixed(1)}%</span></div>
      `;
      
      resultDiv.style.display = 'block';
      projectionDiv.style.display = 'block';
      
      drawPieChart(stockRatio, bondRatio, cashRatio);
    }

    // 파이 차트 그리기
    function drawPieChart(stockRatio, bondRatio, cashRatio) {
      const canvas = document.getElementById('pieChart');
      const ctx = canvas.getContext('2d');
      const centerX = canvas.width / 2;
      const centerY = canvas.height / 2;
      const radius = 100;
      
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      
      const data = [
        { label: '주식', value: stockRatio, color: '#3b82f6' },
        { label: '채권', value: bondRatio, color: '#10b981' },
        { label: '현금', value: cashRatio, color: '#f59e0b' }
      ];
      
      let currentAngle = -Math.PI / 2; // 12시 방향부터 시작
      
      data.forEach((item, index) => {
        if (item.value > 0) {
          const sliceAngle = (item.value * 2 * Math.PI);
          
          // 파이 슬라이스 그리기
          ctx.beginPath();
          ctx.moveTo(centerX, centerY);
          ctx.arc(centerX, centerY, radius, currentAngle, currentAngle + sliceAngle);
          ctx.closePath();
          ctx.fillStyle = item.color;
          ctx.fill();
          
          // 라벨 그리기
          const labelAngle = currentAngle + sliceAngle / 2;
          const labelX = centerX + Math.cos(labelAngle) * (radius * 0.7);
          const labelY = centerY + Math.sin(labelAngle) * (radius * 0.7);
          
          ctx.fillStyle = 'white';
          ctx.font = 'bold 14px Arial';
          ctx.textAlign = 'center';
          ctx.fillText(`${item.label}`, labelX, labelY - 5);
          ctx.fillText(`${(item.value * 100).toFixed(0)}%`, labelX, labelY + 10);
          
          currentAngle += sliceAngle;
        }
      });
    }

    // 페이지 로드 시 기본 계산 실행
    window.onload = function() {
      updateAllocation();
      getRecommendation();
    };
  </script>
</body>
</html>