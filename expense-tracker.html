<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>지출 분석 계산기 - GIROK labs</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', 'Apple SD Gothic Neo', Arial, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      color: #333;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }

    .header {
      text-align: center;
      color: white;
      margin-bottom: 30px;
    }

    .header h1 {
      font-size: 2.5em;
      margin-bottom: 10px;
      text-shadow: 0 2px 4px rgba(0,0,0,0.3);
    }

    .nav-link {
      color: white;
      text-decoration: none;
      margin: 0 10px;
      padding: 8px 16px;
      border-radius: 20px;
      background: rgba(255,255,255,0.2);
      transition: background 0.3s ease;
    }

    .nav-link:hover {
      background: rgba(255,255,255,0.3);
    }

    .calculator-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-bottom: 30px;
    }

    .calculator-card {
      background: white;
      border-radius: 16px;
      padding: 30px;
      box-shadow: 0 8px 32px rgba(0,0,0,0.1);
    }

    .full-width {
      grid-column: 1 / -1;
    }

    .card-title {
      font-size: 1.4em;
      color: #2563eb;
      margin-bottom: 20px;
      text-align: center;
      font-weight: 600;
    }

    .input-group {
      margin-bottom: 15px;
    }

    .input-group label {
      display: block;
      margin-bottom: 8px;
      font-weight: 500;
      color: #374151;
    }

    .input-group input, .input-group select {
      width: 100%;
      padding: 12px 16px;
      border: 2px solid #e5e7eb;
      border-radius: 8px;
      font-size: 16px;
      transition: border-color 0.3s ease;
    }

    .input-group input:focus, .input-group select:focus {
      outline: none;
      border-color: #2563eb;
    }

    .expense-category {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 15px;
      margin-bottom: 15px;
    }

    .calculate-btn {
      width: 100%;
      background: linear-gradient(135deg, #2563eb, #3b82f6);
      color: white;
      border: none;
      padding: 14px 20px;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      margin-top: 10px;
    }

    .calculate-btn:hover {
      background: linear-gradient(135deg, #1d4ed8, #2563eb);
      transform: translateY(-1px);
    }

    .result {
      margin-top: 20px;
      padding: 20px;
      background: #f0f9ff;
      border-radius: 8px;
      border-left: 4px solid #2563eb;
    }

    .result h3 {
      color: #1e40af;
      margin-bottom: 15px;
    }

    .result-item {
      margin: 8px 0;
      font-size: 1.1em;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .highlight {
      font-weight: 600;
      color: #dc2626;
    }

    .success {
      color: #059669;
    }

    .warning {
      color: #d97706;
    }

    .progress-bar {
      width: 100%;
      height: 20px;
      background: #e5e7eb;
      border-radius: 10px;
      overflow: hidden;
      margin: 10px 0;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #10b981, #059669);
      transition: width 0.5s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: 600;
      font-size: 12px;
    }

    .chart-container {
      height: 300px;
      background: #f8fafc;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-top: 20px;
      position: relative;
    }

    .savings-goal {
      background: #fef3c7;
      border: 2px solid #f59e0b;
      border-radius: 8px;
      padding: 15px;
      margin-top: 15px;
    }

    .savings-goal h4 {
      color: #92400e;
      margin-bottom: 10px;
    }

    @media (max-width: 768px) {
      .calculator-grid {
        grid-template-columns: 1fr;
      }
      
      .expense-category {
        grid-template-columns: 1fr;
      }
      
      .header h1 {
        font-size: 2em;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>📊 지출 분석 계산기</h1>
      <p>월 지출을 분석하고 FIRE 달성을 위한 절약 목표를 설정하세요</p>
      <div style="margin-top: 15px;">
        <a href="index.html" class="nav-link">🏠 홈</a>
        <a href="fire-calculator.html" class="nav-link">🔥 FIRE 계산기</a>
        <a href="asset-allocation.html" class="nav-link">📊 자산 배분</a>
        <a href="gift-tax-calculator.html" class="nav-link">💰 증여세 계산기</a>
      </div>
    </div>

    <div class="calculator-grid">
      <!-- 지출 입력 -->
      <div class="calculator-card">
        <div class="card-title">💰 월 지출 입력</div>
        
        <div class="input-group">
          <label for="monthlyIncome">월 소득 (만원)</label>
          <input type="number" id="monthlyIncome" value="500" min="0">
        </div>

        <div class="expense-category">
          <div class="input-group">
            <label for="housing">주거비 (만원)</label>
            <input type="number" id="housing" value="120" min="0">
          </div>
          <div class="input-group">
            <label for="food">식비 (만원)</label>
            <input type="number" id="food" value="60" min="0">
          </div>
          <div class="input-group">
            <label for="transportation">교통비 (만원)</label>
            <input type="number" id="transportation" value="30" min="0">
          </div>
          <div class="input-group">
            <label for="utilities">공과금 (만원)</label>
            <input type="number" id="utilities" value="15" min="0">
          </div>
          <div class="input-group">
            <label for="healthcare">의료비 (만원)</label>
            <input type="number" id="healthcare" value="10" min="0">
          </div>
          <div class="input-group">
            <label for="entertainment">여가/오락 (만원)</label>
            <input type="number" id="entertainment" value="40" min="0">
          </div>
          <div class="input-group">
            <label for="shopping">쇼핑 (만원)</label>
            <input type="number" id="shopping" value="35" min="0">
          </div>
          <div class="input-group">
            <label for="others">기타 (만원)</label>
            <input type="number" id="others" value="20" min="0">
          </div>
        </div>
        
        <button class="calculate-btn" onclick="analyzeExpenses()">지출 분석하기</button>
      </div>

      <!-- 지출 분석 결과 -->
      <div class="calculator-card">
        <div class="card-title">📈 지출 분석 결과</div>
        
        <div id="expenseResult" class="result" style="display: none;">
          <h3>💸 월 지출 현황</h3>
          <div id="expenseDetails"></div>
        </div>

        <div id="savingsAnalysis" class="result" style="display: none;">
          <h3>💰 저축 분석</h3>
          <div id="savingsDetails"></div>
        </div>
      </div>

      <!-- 절약 목표 설정 -->
      <div class="calculator-card full-width">
        <div class="card-title">🎯 절약 목표 설정</div>
        
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
          <div>
            <div class="input-group">
              <label for="savingsGoal">목표 저축률 (%)</label>
              <input type="number" id="savingsGoal" value="30" min="0" max="70">
            </div>
            
            <div class="input-group">
              <label for="targetPeriod">목표 달성 기간 (개월)</label>
              <input type="number" id="targetPeriod" value="12" min="1" max="60">
            </div>
            
            <button class="calculate-btn" onclick="calculateSavingsGoal()">절약 목표 계산</button>
          </div>
          
          <div id="goalResult" class="result" style="display: none;">
            <h3>🏆 절약 목표 결과</h3>
            <div id="goalDetails"></div>
          </div>
        </div>

        <div id="recommendationsResult" style="display: none; margin-top: 20px;">
          <h3 style="color: #2563eb; margin-bottom: 15px;">💡 절약 추천 사항</h3>
          <div id="recommendationsList"></div>
        </div>
      </div>
    </div>
  </div>

  <script>
    function formatNumber(num) {
      return new Intl.NumberFormat('ko-KR').format(Math.round(num));
    }

    function analyzeExpenses() {
      const income = parseFloat(document.getElementById('monthlyIncome').value);
      const housing = parseFloat(document.getElementById('housing').value);
      const food = parseFloat(document.getElementById('food').value);
      const transportation = parseFloat(document.getElementById('transportation').value);
      const utilities = parseFloat(document.getElementById('utilities').value);
      const healthcare = parseFloat(document.getElementById('healthcare').value);
      const entertainment = parseFloat(document.getElementById('entertainment').value);
      const shopping = parseFloat(document.getElementById('shopping').value);
      const others = parseFloat(document.getElementById('others').value);

      const totalExpenses = housing + food + transportation + utilities + healthcare + entertainment + shopping + others;
      const savings = income - totalExpenses;
      const savingsRate = (savings / income) * 100;

      const expenses = [
        { name: '주거비', amount: housing, color: '#3b82f6' },
        { name: '식비', amount: food, color: '#10b981' },
        { name: '교통비', amount: transportation, color: '#f59e0b' },
        { name: '공과금', amount: utilities, color: '#8b5cf6' },
        { name: '의료비', amount: healthcare, color: '#ef4444' },
        { name: '여가/오락', amount: entertainment, color: '#06b6d4' },
        { name: '쇼핑', amount: shopping, color: '#f97316' },
        { name: '기타', amount: others, color: '#84cc16' }
      ];

      // 지출 결과 표시
      const resultDiv = document.getElementById('expenseResult');
      const detailsDiv = document.getElementById('expenseDetails');
      
      let expenseBreakdown = '';
      expenses.forEach(expense => {
        const percentage = (expense.amount / totalExpenses) * 100;
        expenseBreakdown += `
          <div class="result-item">
            <span>${expense.name}</span>
            <span class="highlight">${formatNumber(expense.amount)}만원 (${percentage.toFixed(1)}%)</span>
          </div>
        `;
      });

      detailsDiv.innerHTML = `
        <div class="result-item">
          <span>총 월 지출</span>
          <span class="highlight">${formatNumber(totalExpenses)}만원</span>
        </div>
        ${expenseBreakdown}
      `;

      // 저축 분석
      const savingsDiv = document.getElementById('savingsAnalysis');
      const savingsDetailsDiv = document.getElementById('savingsDetails');
      
      const savingsStatus = savingsRate >= 30 ? 'success' : savingsRate >= 20 ? 'warning' : 'highlight';
      const savingsMessage = savingsRate >= 30 ? '훌륭한 저축률입니다!' : 
                             savingsRate >= 20 ? '양호한 저축률이지만 더 개선할 여지가 있습니다.' :
                             '저축률이 낮습니다. 지출 절약이 필요합니다.';

      savingsDetailsDiv.innerHTML = `
        <div class="result-item">
          <span>월 저축액</span>
          <span class="${savingsStatus}">${formatNumber(savings)}만원</span>
        </div>
        <div class="result-item">
          <span>저축률</span>
          <span class="${savingsStatus}">${savingsRate.toFixed(1)}%</span>
        </div>
        <div class="savings-goal">
          <h4>${savingsMessage}</h4>
          <p>FIRE 달성을 위한 권장 저축률: 25% 이상</p>
        </div>
      `;

      resultDiv.style.display = 'block';
      savingsDiv.style.display = 'block';

      // 절약 추천사항 생성
      generateRecommendations(expenses, income, totalExpenses);
    }

    function generateRecommendations(expenses, income, totalExpenses) {
      const recommendations = [];
      
      expenses.forEach(expense => {
        const percentage = (expense.amount / totalExpenses) * 100;
        
        if (expense.name === '주거비' && percentage > 30) {
          recommendations.push(`주거비가 총 지출의 ${percentage.toFixed(1)}%로 높습니다. 더 저렴한 주거지 고려 또는 룸메이트 구하기를 추천합니다.`);
        }
        if (expense.name === '식비' && percentage > 20) {
          recommendations.push(`식비가 ${percentage.toFixed(1)}%로 높습니다. 외식 줄이기, 도시락 준비하기를 추천합니다.`);
        }
        if (expense.name === '여가/오락' && percentage > 15) {
          recommendations.push(`여가비가 ${percentage.toFixed(1)}%로 높습니다. 무료 또는 저렴한 여가활동을 찾아보세요.`);
        }
        if (expense.name === '쇼핑' && percentage > 10) {
          recommendations.push(`쇼핑비가 ${percentage.toFixed(1)}%로 높습니다. 필수품 위주로 구매하고 할인 시기를 활용하세요.`);
        }
        if (expense.name === '교통비' && percentage > 10) {
          recommendations.push(`교통비가 ${percentage.toFixed(1)}%로 높습니다. 대중교통 이용이나 카풀을 고려해보세요.`);
        }
      });

      // 일반적인 절약 팁 추가
      recommendations.push('구독 서비스를 정리하고 실제로 사용하는 것만 유지하세요.');
      recommendations.push('에너지 효율적인 가전제품 사용으로 공과금을 절약하세요.');
      recommendations.push('쿠폰, 할인 혜택을 적극 활용하세요.');
      recommendations.push('중고 거래를 통해 필요한 물건을 저렴하게 구매하세요.');

      const recommendationsDiv = document.getElementById('recommendationsResult');
      const recommendationsListDiv = document.getElementById('recommendationsList');
      
      let recommendationHTML = '';
      recommendations.slice(0, 6).forEach((rec, index) => {
        recommendationHTML += `
          <div style="background: #f0f9ff; padding: 12px; margin: 8px 0; border-radius: 6px; border-left: 4px solid #2563eb;">
            ${index + 1}. ${rec}
          </div>
        `;
      });
      
      recommendationsListDiv.innerHTML = recommendationHTML;
      recommendationsDiv.style.display = 'block';
    }

    function calculateSavingsGoal() {
      const income = parseFloat(document.getElementById('monthlyIncome').value);
      const savingsGoal = parseFloat(document.getElementById('savingsGoal').value) / 100;
      const targetPeriod = parseInt(document.getElementById('targetPeriod').value);

      const currentExpenses = parseFloat(document.getElementById('housing').value) +
                             parseFloat(document.getElementById('food').value) +
                             parseFloat(document.getElementById('transportation').value) +
                             parseFloat(document.getElementById('utilities').value) +
                             parseFloat(document.getElementById('healthcare').value) +
                             parseFloat(document.getElementById('entertainment').value) +
                             parseFloat(document.getElementById('shopping').value) +
                             parseFloat(document.getElementById('others').value);

      const currentSavings = income - currentExpenses;
      const currentSavingsRate = (currentSavings / income) * 100;
      
      const targetSavings = income * savingsGoal;
      const targetExpenses = income - targetSavings;
      const requiredCut = currentExpenses - targetExpenses;
      const monthlyCutNeeded = requiredCut / targetPeriod;

      const goalDiv = document.getElementById('goalResult');
      const goalDetailsDiv = document.getElementById('goalDetails');
      
      if (requiredCut <= 0) {
        goalDetailsDiv.innerHTML = `
          <div class="result-item">
            <span>현재 저축률</span>
            <span class="success">${currentSavingsRate.toFixed(1)}%</span>
          </div>
          <div class="result-item">
            <span>목표 달성 상태</span>
            <span class="success">이미 목표를 달성했습니다! 🎉</span>
          </div>
          <div class="result-item">
            <span>추가 저축 여력</span>
            <span class="success">${formatNumber(Math.abs(requiredCut))}만원</span>
          </div>
        `;
      } else {
        goalDetailsDiv.innerHTML = `
          <div class="result-item">
            <span>현재 저축률</span>
            <span class="warning">${currentSavingsRate.toFixed(1)}%</span>
          </div>
          <div class="result-item">
            <span>목표 저축률</span>
            <span class="highlight">${(savingsGoal * 100).toFixed(1)}%</span>
          </div>
          <div class="result-item">
            <span>총 절약 필요 금액</span>
            <span class="highlight">${formatNumber(requiredCut)}만원</span>
          </div>
          <div class="result-item">
            <span>월 절약 목표</span>
            <span class="highlight">${formatNumber(monthlyCutNeeded)}만원</span>
          </div>
          <div class="progress-bar">
            <div class="progress-fill" style="width: ${Math.min((currentSavingsRate / (savingsGoal * 100)) * 100, 100)}%">
              ${Math.min(Math.round((currentSavingsRate / (savingsGoal * 100)) * 100), 100)}%
            </div>
          </div>
        `;
      }

      goalDiv.style.display = 'block';

      // FIRE 달성 시뮬레이션
      if (targetSavings > 0) {
        const fireYears = calculateFIRETime(targetSavings, targetExpenses * 12);
        goalDetailsDiv.innerHTML += `
          <div class="savings-goal">
            <h4>🔥 FIRE 달성 예상</h4>
            <p>목표 저축률 달성 시 FIRE까지: <strong>${fireYears}년</strong></p>
            <p>연간 필요 자산: <strong>${formatNumber(targetExpenses * 12 * 25)}만원</strong> (25배 기준)</p>
          </div>
        `;
      }
    }

    function calculateFIRETime(monthlySavings, annualExpenses) {
      const targetAssets = annualExpenses * 25; // 25배 룰
      const annualReturn = 0.07; // 7% 가정
      
      let assets = 0;
      let years = 0;
      const monthlyReturn = annualReturn / 12;
      
      while (assets < targetAssets && years < 50) {
        assets = assets * (1 + monthlyReturn) + monthlySavings;
        years += 1/12;
      }
      
      return Math.ceil(years);
    }

    // 페이지 로드 시 기본 계산 실행
    window.onload = function() {
      analyzeExpenses();
      calculateSavingsGoal();
    };
  </script>
</body>
</html>